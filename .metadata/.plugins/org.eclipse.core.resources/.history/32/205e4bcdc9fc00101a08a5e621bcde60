package com.revhire.service;

import com.revhire.dao.CompanyDao;
import com.revhire.dao.CompanyDaoImpl;
import com.revhire.dao.JobSeekerDao;
import com.revhire.dao.JobSeekerDaoImpl;
import com.revhire.dao.UserDao;
import com.revhire.dao.UserDaoImpl;
import com.revhire.model.Company;
import com.revhire.model.User;

public class AuthServiceImpl implements AuthService {

    private UserDao userDao = new UserDaoImpl();

    @Override
    public boolean register(User user) {
    	int userId = userDao.registerUser(user);

    	if (userId > 0) {
    	    System.out.println("✅ Registration successful");

    	    if ("EMPLOYER".equalsIgnoreCase(user.getRole())) {
    	        Company c = new Company();
    	        c.setEmployerId(userId);
    	        c.setCompanyName("Not Updated");
    	        c.setIndustry("Not Updated");
    	        c.setCompanySize(0);
    	        c.setDescription("Not Updated");
    	        c.setWebsite("Not Updated");
    	        c.setLocation("Not Updated");

    	        CompanyDao companyDao = new CompanyDaoImpl();
    	        companyDao.createCompany(c);
    	    }

    	    return true;
    	}

    	return false;

    }

    @Override
    public User login(String email, String password) {

        if (email.isEmpty() || password.isEmpty()) {
            System.out.println("❌ Invalid login credentials");
            return null;
        }

        return userDao.login(email, password);
    }

    @Override
    public boolean changePassword(int userId, String newPassword) {

        if (newPassword.length() < 4) {
            System.out.println("❌ Password too short");
            return false;
        }

        return userDao.changePassword(userId, newPassword);
    }
}
